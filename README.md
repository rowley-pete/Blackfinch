Got carried away, once I'd started I needed to finish and I wrote the tests so I could be sure I'd hit brief.

Not happy with the result, used Chain of Responsibility pattern but I'm not fond of the nested handlers in constructors looks more complicated than I want it to be.

It works, so...